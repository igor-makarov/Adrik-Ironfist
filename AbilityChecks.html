<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Skills Table</title>
  <style>
    * {
      box-sizing: border-box;
    }

    .row {
      margin-left: -5px;
      margin-right: -5px;
    }

    .column {
      float: left;
      width: 33%;
      padding: 5px;
    }

    /* Clearfix (clear floats) */
    .row::after {
      content: "";
      clear: both;
      display: table;
    }

    table {
      border-collapse: collapse;
      border-spacing: 0;
      width: 100%;
      border: 1px solid #ddd;
    }

    th,
    td {
      text-align: left;
    }

    td.checkCell {
      width: 20%;
    }
  </style>
</head>

<body>
  <script>
    let abilities = {
      'Str': 0,
      'Dex': 1,
      'Con': 2,
      'Int': 2,
      'Wis': 3,
      'Cha': 1
    }

    let proficiencyBonus = 3

    let skills = [
      { skill: 'Acrobatics', modifier: 'Dex' },
      { skill: 'Animal Handling', modifier: 'Wis' },
      { skill: 'Arcana', modifier: 'Int', proficient: true },
      { skill: 'Athletics', modifier: 'Str' },
      { skill: 'Deception', modifier: 'Cha' },
      { skill: 'History', modifier: 'Int', proficient: true },
      { skill: 'Insight', modifier: 'Wis' },
      { skill: 'Intimidation', modifier: 'Cha' },
      { skill: 'Investigation', modifier: 'Int', proficient: true },
      { skill: 'Medicine', modifier: 'Wis' },
      { skill: 'Nature', modifier: 'Int', proficient: true },
      { skill: 'Perception', modifier: 'Wis' },
      { skill: 'Performance', modifier: 'Cha' },
      { skill: 'Persuasion', modifier: 'Cha' },
      { skill: 'Religion', modifier: 'Int' },
      { skill: 'Sleight of Hand', modifier: 'Dex' },
      { skill: 'Stealth', modifier: 'Dex' },
      { skill: 'Survival', modifier: 'Wis', proficient: true },
    ]

    function abilityBonus(ability) {
      return abilities[ability]
    }

    function createProficiency(proficient, multiplier) {
      multiplier ||= 1
      let symbol = multiplier > 1 ? 'E' : 'P'
      return { proficiency: proficient ? symbol : ' ', bonus: (proficient ? 1 : 0) * proficiencyBonus * multiplier }
    }

    function rollD20Url(modifier) {
      return `dice://roll/d20+${modifier}`
    }

    function rollD20Hrefs(modifier) {
      return `<a href="${rollD20Url(modifier)}">+${modifier}</a> <a href="${rollD20Url(modifier)}(ADV)">ADV</a> <a href="${rollD20Url(modifier)}(DIS)">DIS</a>`
    }

    function createSkillRow(skill, proficiencyMultiplier) {
      let skillRow = document.createElement('tr')
      let skillCell = document.createElement('td')
      skillRow.appendChild(skillCell)
      let proficiency = createProficiency(skill.proficient, proficiencyMultiplier)
      skillCell.innerHTML = `<code>[${proficiency.proficiency}]</code> ${skill.skill} (${skill.modifier})`
      let modifier = abilityBonus(skill.modifier) + proficiency.bonus
      let checkCell = document.createElement('td')
      skillRow.appendChild(checkCell)
      checkCell.className = 'checkCell'
      checkCell.innerHTML = rollD20Hrefs(modifier)
      return skillRow
    }

    function calculateModifiers(table, filter, proficiencyMultiplier) {
      filter ||= skill => true
      for (skill of skills) {
        if (!filter(skill)) { continue }
        let skillRow = createSkillRow(skill, proficiencyMultiplier)
        table.appendChild(skillRow)
      }
    }
  </script>
  <div class="row">
    <div class="column">
      <table id="skillsTable">
        <tr>
          <th>Skill</th>
          <th>Modifier</th>
        </tr>
      </table>
    </div>
    <div class="column">
      <table id="intTable">
        <tr>
          <th colspan="2" style="text-align: center;">Int checks</th>
        </tr>
        <tr>
          <th>Skill</th>
          <th>Modifier</th>
        </tr>
      </table>
      <table id="wisTable">
        <tr>
          <th colspan="2" style="text-align: center;">Wis checks</th>
        </tr>
        <tr>
          <th>Skill</th>
          <th>Modifier</th>
        </tr>
      </table>
    </div>
    <div class="column">
      <table id="favoredTerrainTable">
        <tr>
          <th colspan="2" style="text-align: center;">Favored Terrain</th>
        </tr>
        <tr>
          <th>Skill</th>
          <th>Modifier</th>
        </tr>
      </table>
      <table id="favoredEnemyTable">
        <tr>
          <th colspan="2" style="text-align: center;">Favored Enemy<br>(orc, goblin)</th>
        </tr>
        <tr>
          <th>Skill</th>
          <th>Modifier <br>use ADV!</th>
        </tr>
      </table>
      <table id="stonecunningTable">
        <tr>
          <th colspan="2" style="text-align: center;">Stonecunning</th>
        </tr>
        <tr>
          <th>Skill</th>
          <th>Modifier</th>
        </tr>
      </table>
    </div>
  </div>
  <script>
    calculateModifiers(document.querySelector('[id=skillsTable]'))
    calculateModifiers(document.querySelector('[id=intTable]'), s => s.modifier == 'Int')
    calculateModifiers(document.querySelector('[id=wisTable]'), s => s.modifier == 'Wis')
    calculateModifiers(document.querySelector('[id=favoredTerrainTable]'),
      s => (s.modifier == 'Int' || s.modifier == 'Wis') && s.proficient,
      2)
    calculateModifiers(document.querySelector('[id=favoredEnemyTable]'),
      s => s.modifier == 'Int' || s.skill == 'Survival')
    calculateModifiers(document.querySelector('[id=stonecunningTable]'), s => s.skill == 'History', 2)
  </script>

</body>

</html>